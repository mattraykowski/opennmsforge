<p id="notice"><%= notice %></p>

<div class="row-fluid">
    <div class="span8">
        <dl class="dl-horizontal">
            <dt>Name:</dt>
            <dd><%= @config_pack.name %></dd>

            <dt>Last Updated:</dt>
            <dd><%= distance_of_time_in_words @config_pack.updated_at, Date.today %> ago</dd>

            <dt>Rating:</dt>
            <dd><%= rating_for @config_pack, "pack_overall" %></dd>

            <dt>Vendor:</dt>
            <dd><%= @config_pack.vendor %></dd>

            <dt>Product:</dt>
            <dd><%= @config_pack.product %></dd>

            <% if user_signed_in? %>
                <% if @config_pack.user == current_user %>
            <dt>Actions</dt>
            <dd>
                <div class="btn-group">
                    <%= link_to raw('<i class="icon-edit"></i>'), edit_config_pack_path(@config_pack), class: "btn btn-mini" %>
                    <%= link_to raw('<i class="icon-remove"></i>'), @config_pack, method: :delete, data: { confirm: 'Are you sure?' }, class: "btn btn-mini" %>
                </div>
            </dd>
                <% end %>
            <% end %>

        </dl>
    </div>
    <div class="span4">
        <div class="well">
            <div class="row-fluid">
                <div class="span12">
                    <h4>Contributor</h4>
                </div>
            </div>
            <div class="row-fluid">
                <div class="span3">
                    <%= gravatar_image_tag(@config_pack.user.email, alt: @config_pack.user.name) %>
                </div>
                <div class="span4">
                    <%= @config_pack.user.name %> <br/>
                    <strong>Member Since</strong> <br/>
                    <%= @config_pack.user.created_at.to_s(:month_and_year) %> <br/>
                    <strong>Contributions</strong> <%= @config_pack.user.config_packs.size %>
                </div>
            </div>


        </div>
    </div>
</div>
<div class="row-fluid">
    <div class="span8">
        <div class="well">
            <h4>Tags</h4>
        </div>
    </div>
    <div class="span4">
        <div class="well">
            <h4>Versions</h4>
        </div>
    </div>
</div>
<div class="row-fluid">
    <div class="span12">
        <div class="well">
            <div class="tabbable"> <!-- Only required for left/right tabs -->
                <ul class="nav nav-tabs">
                    <li class="active"><a href="#tab-summary" data-toggle="tab">Summary</a></li>
                    <li><a href="#tab-install" data-toggle="tab">Install Docs</a></li>
                </ul>
                <div class="tab-content">
                    <div class="tab-pane active" id="tab-summary">
                        <%=  textilize(@config_pack.summary).html_safe %>
                    </div>
                    <div class="tab-pane" id="tab-install">
                        <%= textilize(@config_pack.install).html_safe %>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="row-fluid">
    <div class="span12">
        <div class="well">
            <div class="tabbable"> <!-- Only required for left/right tabs -->
                <ul class="nav nav-tabs">
                    <li class="active"><a href="#tab-eventfiles" data-toggle="tab">Event Configs</a></li>
                    <li><a href="#tab-collectionfiles" data-toggle="tab">Collection Configs</a></li>
                </ul>
                <div class="tab-content">
                    <div class="tab-pane active" id="tab-eventfiles">
                        <%= render partial: "files_tab_partial", locals: { file_collection: @config_pack.event_files, file_type: "Event", dest_url: new_config_pack_event_file_path(@config_pack)} %>
                    </div>
                    <div class="tab-pane" id="tab-collectionfiles">
                        <%= render partial: "files_tab_partial", locals: { file_collection: @config_pack.event_files, file_type: "Collection", dest_url: new_config_pack_event_file_path(@config_pack)} %>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<% if user_signed_in? %>
  <% if @config_pack.user == current_user %>
<%= link_to 'Edit', edit_config_pack_path(@config_pack), class: "btn btn-warning btn-small" %>
  <% end %>
<% end %>
<%= link_to 'Back', config_packs_path, class: "btn btn-primary btn-small" %>

    <h4>Comments</h4>

    <% @config_pack.comments.each do |comment| %>
        <div class="well">
            <div class="row-fluid">
                <div class="span2">
                    <%= gravatar_image_tag(comment.user.email, alt: comment.user.name, gravatar: { size: 45 }) %> <br/>
                    <%= comment.user.name %><br/>
                    Since <%= comment.user.created_at.to_s(:month_and_year) %>
                </div>
                <div class="span10">
                    <p class="lead"><%= comment.title %></p>
                    <p><%= comment.comment %></p>
                </div>
            </div>
        </div>
    <% end %>


<%= form_tag("/config_packs/"+@config_pack.id.to_s+"/comment", :method => "post", :class => "form-horizontal") do %>
  <br/><br/>
  <fieldset>
      <%= text_field_tag "title", nil, :class => "input-block-level", :placeholder => "Title" %>
      <%= text_area_tag "body", nil, :rows => 5, :class => "input-block-level", :placeholder => "Comment text..."  %>
      <%= submit_tag "Add Comment", :class => "btn btn-primary" %>
  </fieldset>
<% end %>
